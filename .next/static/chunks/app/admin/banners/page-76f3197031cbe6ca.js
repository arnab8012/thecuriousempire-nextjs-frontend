(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[734],{454:(e,t,a)=>{"use strict";a.d(t,{default:()=>c});var n=a(5155),r=a(2115),i=a(4975),s=a(6165),l=a(9109);function o(){let e=(0,r.useRef)(null),[t,a]=(0,r.useState)(!0),[s,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)([]),[m,p]=(0,r.useState)([]),[b,g]=(0,r.useState)(""),f=(0,r.useMemo)(()=>e=>{if(!e)return"";let t=String(e);return t.startsWith("http://")||t.startsWith("https://")?t:"".concat(i.F.BASE).concat(t.startsWith("/")?"":"/").concat(t)},[]),y=async()=>{a(!0);try{let e=await i.F.get("/api/banners");h((null==e?void 0:e.ok)&&e.banners||[])}finally{a(!1)}};(0,r.useEffect)(()=>{y()},[]);let v=async t=>{let a=Array.from(t||[]);if(!a.length)return;let n=a.slice(0,10);o(!0);let r=new FormData;for(let e of n)r.append("images",e);try{let e=i.F.adminToken(),t=await fetch("".concat(i.F.BASE,"/api/admin/upload/banner-images"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:r}),a=await t.json();if(!(null==a?void 0:a.ok))return void alert((null==a?void 0:a.message)||"Upload failed");let n=(Array.isArray(a.banners)?a.banners:[]).map(e=>({...e,url:f(null==e?void 0:e.url)}));p(e=>[...e,...n].slice(0,10))}catch(e){alert("Upload error")}finally{o(!1),e.current&&(e.current.value="")}},j=async()=>{if(!m.length)return alert("No banners to save");d(!0);try{let e=i.F.adminToken(),t=await i.F.post("/api/admin/banners",{banners:m},e);if(!(null==t?void 0:t.ok))return void alert((null==t?void 0:t.message)||"Save failed");p([]),await y(),alert("✅ Banners saved")}finally{d(!1)}},x=async e=>{if(!confirm("Delete this banner?"))return;let t=i.F.adminToken(),a=await fetch("".concat(i.F.BASE,"/api/admin/banners/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}}),n=await a.json();if(!(null==n?void 0:n.ok))return alert((null==n?void 0:n.message)||"Delete failed");y()};return(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("div",{className:"rowBetween",children:[(0,n.jsx)("h2",{style:{margin:0},children:"Admin Banners"}),(0,n.jsx)(l.A,{className:"btnGhost",to:"/admin",children:"← Back"})]}),(0,n.jsxs)("div",{className:"box adminCard",children:[(0,n.jsx)("label",{className:"lbl",children:"Upload Banner Images (Max 10)"}),(0,n.jsx)("input",{ref:e,type:"file",multiple:!0,accept:"image/*",disabled:s,onChange:e=>v(e.target.files)}),s&&(0,n.jsx)("div",{className:"muted",style:{marginTop:8},children:"Uploading..."}),(0,n.jsx)("hr",{style:{margin:"12px 0"}}),(0,n.jsx)("label",{className:"lbl",children:"Add Banner by Image Link (URL)"}),(0,n.jsxs)("div",{className:"rowBetween",style:{gap:10},children:[(0,n.jsx)("input",{className:"input",value:b,placeholder:"https://example.com/banner.jpg",onChange:e=>g(e.target.value)}),(0,n.jsx)("button",{className:"btnGhost",type:"button",onClick:()=>{let e=String(b||"").trim();return e?e.startsWith("http")?void(p(t=>[...t,{url:e,public_id:"link_only"}].slice(0,10)),g("")):alert("Valid http/https link দিন"):alert("Image link required")},children:"Add Link"})]}),(0,n.jsx)("div",{style:{marginTop:12},children:(0,n.jsxs)("b",{children:["Pending (not saved): ",m.length]})}),m.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"bannerThumbGrid",children:m.map((e,t)=>(0,n.jsxs)("div",{className:"bannerThumb",children:[(0,n.jsx)("img",{src:f(e.url),alt:""}),(0,n.jsx)("button",{type:"button",className:"thumbX",onClick:()=>{p(e=>e.filter((e,a)=>a!==t))},"aria-label":"remove",children:"✕"})]},e.public_id+t))}),(0,n.jsx)("button",{className:"btnPinkFull",onClick:j,disabled:c||s,style:{marginTop:12},children:c?"Saving...":"Save banners to website"})]}):(0,n.jsx)("div",{className:"muted",style:{marginTop:8},children:"No pending banners"})]}),(0,n.jsxs)("div",{className:"box adminCard",children:[(0,n.jsx)("b",{children:"Live banners on website"}),t?(0,n.jsx)("div",{className:"muted",style:{marginTop:8},children:"Loading..."}):0===u.length?(0,n.jsx)("div",{className:"muted",style:{marginTop:8},children:"No banners yet"}):(0,n.jsx)("div",{className:"bannerThumbGrid",style:{marginTop:10},children:u.map(e=>(0,n.jsxs)("div",{className:"bannerThumb",children:[(0,n.jsx)("img",{src:f(e.url),alt:""}),(0,n.jsx)("button",{type:"button",className:"thumbBin",onClick:()=>x(e._id),"aria-label":"delete",children:"\uD83D\uDDD1"})]},e._id))})]})]})}function c(){return(0,n.jsx)(s.default,{children:(0,n.jsx)(o,{})})}},1834:(e,t,a)=>{"use strict";a.d(t,{z:()=>r});var n=a(63);function r(){let e=(0,n.usePathname)()||"/",t=(0,n.useSearchParams)();return{pathname:e,search:(null==t?void 0:t.toString())?"?".concat(t.toString()):""}}},2757:(e,t,a)=>{Promise.resolve().then(a.bind(a,6165)),Promise.resolve().then(a.bind(a,454))},4975:(e,t,a)=>{"use strict";a.d(t,{F:()=>i});let n=String("https://ecom-backend-rql0.onrender.com").replace(/\/$/,"");async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=await fetch(e,{...t,credentials:"include"}),n=await a.text(),r={};try{r=n?JSON.parse(n):{}}catch(e){r={ok:!1,message:n||"Non-JSON response"}}return a.ok||!r||"object"!=typeof r||"status"in r||(r.status=a.status),r}catch(e){return{ok:!1,message:(null==e?void 0:e.message)||"Network error"}}}let i={BASE:n,get:e=>r("".concat(n).concat(e),{method:"GET"}),getAuth:(e,t)=>r("".concat(n).concat(e),{method:"GET",headers:t?{Authorization:"Bearer ".concat(t)}:{}}),post:(e,t,a)=>r("".concat(n).concat(e),{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:"Bearer ".concat(a)}:{}},body:JSON.stringify(t||{})}),postForm:(e,t,a)=>r("".concat(n).concat(e),{method:"POST",headers:{...a?{Authorization:"Bearer ".concat(a)}:{}},body:t}),postAuth:(e,t,a)=>r("".concat(n).concat(e),{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:"Bearer ".concat(t)}:{}},body:JSON.stringify(a||{})}),put:(e,t,a)=>r("".concat(n).concat(e),{method:"PUT",headers:{"Content-Type":"application/json",...a?{Authorization:"Bearer ".concat(a)}:{}},body:JSON.stringify(t||{})}),putAuth:(e,t,a)=>r("".concat(n).concat(e),{method:"PUT",headers:{"Content-Type":"application/json",...t?{Authorization:"Bearer ".concat(t)}:{}},body:JSON.stringify(a||{})}),delete:(e,t)=>r("".concat(n).concat(e),{method:"DELETE",headers:t?{Authorization:"Bearer ".concat(t)}:{}}),token:function(){return localStorage.getItem("token")||""},adminToken:function(){return localStorage.getItem("admin_token")||""}}},6165:(e,t,a)=>{"use strict";a.d(t,{default:()=>o});var n=a(5155),r=a(2115),i=a(6848),s=a(1834),l=a(4975);function o(e){let{children:t}=e;(0,s.z)();let[a,o]=(0,r.useState)(null);return((0,r.useEffect)(()=>{let e=localStorage.getItem("admin_token")||"";if(!e)return void o(!1);(async()=>{try{let t=await l.F.getAuth("/api/admin-auth/me",e);(null==t?void 0:t.ok)?o(!0):o(!1)}catch(e){o(!1)}})()},[]),null===a)?(0,n.jsx)("div",{style:{padding:20,fontSize:16},children:"Checking admin..."}):a?t:(0,n.jsx)(i.A,{to:"/admin/login",replace:!0})}},6848:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var n=a(2115),r=a(63);function i(e){let{to:t="/",replace:a=!1}=e,i=(0,r.useRouter)();return(0,n.useEffect)(()=>{a?i.replace(t):i.push(t)},[t,a,i]),null}},9109:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var n=a(5155),r=a(2619),i=a.n(r);function s(e){var t;let{to:a,href:r,...s}=e;return(0,n.jsx)(i(),{href:null!=(t=null!=r?r:a)?t:"#",...s})}}},e=>{e.O(0,[176,441,493,358],()=>e(e.s=2757)),_N_E=e.O()}]);