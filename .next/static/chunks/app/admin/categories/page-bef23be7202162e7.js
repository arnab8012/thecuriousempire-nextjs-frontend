(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[631],{1834:(e,t,a)=>{"use strict";a.d(t,{z:()=>o});var n=a(63);function o(){let e=(0,n.usePathname)()||"/",t=(0,n.useSearchParams)();return{pathname:e,search:(null==t?void 0:t.toString())?"?".concat(t.toString()):""}}},4975:(e,t,a)=>{"use strict";a.d(t,{F:()=>r});let n=String("https://ecom-backend-rql0.onrender.com").replace(/\/$/,"");async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=await fetch(e,{...t,credentials:"include"}),n=await a.text(),o={};try{o=n?JSON.parse(n):{}}catch(e){o={ok:!1,message:n||"Non-JSON response"}}return a.ok||!o||"object"!=typeof o||"status"in o||(o.status=a.status),o}catch(e){return{ok:!1,message:(null==e?void 0:e.message)||"Network error"}}}let r={BASE:n,get:e=>o("".concat(n).concat(e),{method:"GET"}),getAuth:(e,t)=>o("".concat(n).concat(e),{method:"GET",headers:t?{Authorization:"Bearer ".concat(t)}:{}}),post:(e,t,a)=>o("".concat(n).concat(e),{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:"Bearer ".concat(a)}:{}},body:JSON.stringify(t||{})}),postForm:(e,t,a)=>o("".concat(n).concat(e),{method:"POST",headers:{...a?{Authorization:"Bearer ".concat(a)}:{}},body:t}),postAuth:(e,t,a)=>o("".concat(n).concat(e),{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:"Bearer ".concat(t)}:{}},body:JSON.stringify(a||{})}),put:(e,t,a)=>o("".concat(n).concat(e),{method:"PUT",headers:{"Content-Type":"application/json",...a?{Authorization:"Bearer ".concat(a)}:{}},body:JSON.stringify(t||{})}),putAuth:(e,t,a)=>o("".concat(n).concat(e),{method:"PUT",headers:{"Content-Type":"application/json",...t?{Authorization:"Bearer ".concat(t)}:{}},body:JSON.stringify(a||{})}),delete:(e,t)=>o("".concat(n).concat(e),{method:"DELETE",headers:t?{Authorization:"Bearer ".concat(t)}:{}}),token:function(){return localStorage.getItem("token")||""},adminToken:function(){return localStorage.getItem("admin_token")||""}}},6165:(e,t,a)=>{"use strict";a.d(t,{default:()=>l});var n=a(5155),o=a(2115),r=a(6848),i=a(1834),c=a(4975);function l(e){let{children:t}=e;(0,i.z)();let[a,l]=(0,o.useState)(null);return((0,o.useEffect)(()=>{let e=localStorage.getItem("admin_token")||"";if(!e)return void l(!1);(async()=>{try{let t=await c.F.getAuth("/api/admin-auth/me",e);(null==t?void 0:t.ok)?l(!0):l(!1)}catch(e){l(!1)}})()},[]),null===a)?(0,n.jsx)("div",{style:{padding:20,fontSize:16},children:"Checking admin..."}):a?t:(0,n.jsx)(r.A,{to:"/admin/login",replace:!0})}},6262:(e,t,a)=>{Promise.resolve().then(a.bind(a,6165)),Promise.resolve().then(a.bind(a,9565))},6848:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var n=a(2115),o=a(63);function r(e){let{to:t="/",replace:a=!1}=e,r=(0,o.useRouter)();return(0,n.useEffect)(()=>{a?r.replace(t):r.push(t)},[t,a,r]),null}},9109:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var n=a(5155),o=a(2619),r=a.n(o);function i(e){var t;let{to:a,href:o,...i}=e;return(0,n.jsx)(r(),{href:null!=(t=null!=o?o:a)?t:"#",...i})}},9565:(e,t,a)=>{"use strict";a.d(t,{default:()=>s});var n=a(5155),o=a(2115),r=a(4975),i=a(6165),c=a(9109);function l(){let[e,t]=(0,o.useState)([]),[a,i]=(0,o.useState)(""),[l,s]=(0,o.useState)(!1),[d,u]=(0,o.useState)(""),[m,h]=(0,o.useState)(!1),g=async()=>{try{let e=await r.F.get("/api/categories");(null==e?void 0:e.ok)?t(Array.isArray(e.categories)?e.categories:[]):t([])}catch(e){t([])}};async function p(e){h(!0);try{var t;let a=new FormData;a.append("image",e);let n=r.F.adminToken(),o=await r.F.postForm("/api/admin/upload/category-icon",a,n);if(!(null==o?void 0:o.ok))return void alert((null==o?void 0:o.message)||"Icon upload failed");u((null==(t=o.icon)?void 0:t.url)||"")}catch(e){alert("Upload error")}finally{h(!1)}}(0,o.useEffect)(()=>{g()},[]);let y=async()=>{let e=a.trim();if(!e)return alert("Category name required");if(!d)return alert("Category icon required");s(!0);try{let t=r.F.adminToken(),a=await r.F.post("/api/admin/categories",{name:e,icon:d},t);if(!(null==a?void 0:a.ok))return alert((null==a?void 0:a.message)||"Failed");i(""),u(""),await g()}finally{s(!1)}},f=async(e,t)=>{if(!window.confirm('Delete category "'.concat(t,'" ?')))return;let a=r.F.adminToken(),n=await r.F.delete("/api/admin/categories/".concat(e),a);if(!(null==n?void 0:n.ok))return alert((null==n?void 0:n.message)||"Delete failed");g()};return(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("div",{className:"rowBetween",children:[(0,n.jsx)("h2",{style:{margin:0},children:"Admin Categories"}),(0,n.jsx)(c.A,{className:"btnGhost",to:"/admin",children:"â† Back"})]}),(0,n.jsxs)("div",{className:"box adminCard",style:{marginTop:12},children:[(0,n.jsx)("label",{className:"lbl",children:"Category name"}),(0,n.jsx)("input",{className:"input",value:a,onChange:e=>i(e.target.value),placeholder:"e.g. Electronics"}),(0,n.jsx)("label",{className:"lbl",children:"Category icon"}),(0,n.jsx)("input",{className:"input",type:"file",accept:"image/*",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];a&&p(a)}}),m&&(0,n.jsx)("div",{className:"muted",style:{marginTop:6},children:"Uploading icon..."}),d&&(0,n.jsx)("img",{src:d,alt:"Category Icon",style:{width:60,height:60,borderRadius:12,marginTop:8,objectFit:"cover",border:"1px solid #ddd"}}),(0,n.jsx)("button",{className:"btnPinkFull",type:"button",onClick:y,disabled:l,children:l?"Saving...":"Add Category"})]}),(0,n.jsx)("div",{className:"box adminCard",style:{marginTop:12},children:0===e.length?(0,n.jsx)("div",{className:"muted",children:"No categories"}):e.map(e=>(0,n.jsxs)("div",{className:"adminListRow",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:e.name}),(0,n.jsx)("div",{className:"muted",style:{fontSize:12},children:e.createdAt?new Date(e.createdAt).toDateString():""})]}),(0,n.jsx)("button",{className:"btnGhost",type:"button",style:{color:"#ff2d55",borderColor:"rgba(255,45,85,0.25)"},onClick:()=>f(e._id,e.name),children:"Delete"})]},e._id))})]})}function s(){return(0,n.jsx)(i.default,{children:(0,n.jsx)(l,{})})}}},e=>{e.O(0,[176,441,493,358],()=>e(e.s=6262)),_N_E=e.O()}]);