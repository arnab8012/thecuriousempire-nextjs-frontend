(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{1834:(e,t,a)=>{"use strict";a.d(t,{z:()=>s});var n=a(63);function s(){let e=(0,n.usePathname)()||"/",t=(0,n.useSearchParams)();return{pathname:e,search:(null==t?void 0:t.toString())?"?".concat(t.toString()):""}}},4975:(e,t,a)=>{"use strict";a.d(t,{F:()=>i});let n=String("https://ecom-backend-rql0.onrender.com").replace(/\/$/,"");async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=await fetch(e,{...t,credentials:"include"}),n=await a.text(),s={};try{s=n?JSON.parse(n):{}}catch(e){s={ok:!1,message:n||"Non-JSON response"}}return a.ok||!s||"object"!=typeof s||"status"in s||(s.status=a.status),s}catch(e){return{ok:!1,message:(null==e?void 0:e.message)||"Network error"}}}let i={BASE:n,get:e=>s("".concat(n).concat(e),{method:"GET"}),getAuth:(e,t)=>s("".concat(n).concat(e),{method:"GET",headers:t?{Authorization:"Bearer ".concat(t)}:{}}),post:(e,t,a)=>s("".concat(n).concat(e),{method:"POST",headers:{"Content-Type":"application/json",...a?{Authorization:"Bearer ".concat(a)}:{}},body:JSON.stringify(t||{})}),postForm:(e,t,a)=>s("".concat(n).concat(e),{method:"POST",headers:{...a?{Authorization:"Bearer ".concat(a)}:{}},body:t}),postAuth:(e,t,a)=>s("".concat(n).concat(e),{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:"Bearer ".concat(t)}:{}},body:JSON.stringify(a||{})}),put:(e,t,a)=>s("".concat(n).concat(e),{method:"PUT",headers:{"Content-Type":"application/json",...a?{Authorization:"Bearer ".concat(a)}:{}},body:JSON.stringify(t||{})}),putAuth:(e,t,a)=>s("".concat(n).concat(e),{method:"PUT",headers:{"Content-Type":"application/json",...t?{Authorization:"Bearer ".concat(t)}:{}},body:JSON.stringify(a||{})}),delete:(e,t)=>s("".concat(n).concat(e),{method:"DELETE",headers:t?{Authorization:"Bearer ".concat(t)}:{}}),token:function(){return localStorage.getItem("token")||""},adminToken:function(){return localStorage.getItem("admin_token")||""}}},6165:(e,t,a)=>{"use strict";a.d(t,{default:()=>o});var n=a(5155),s=a(2115),i=a(6848),r=a(1834),d=a(4975);function o(e){let{children:t}=e;(0,r.z)();let[a,o]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let e=localStorage.getItem("admin_token")||"";if(!e)return void o(!1);(async()=>{try{let t=await d.F.getAuth("/api/admin-auth/me",e);(null==t?void 0:t.ok)?o(!0):o(!1)}catch(e){o(!1)}})()},[]),null===a)?(0,n.jsx)("div",{style:{padding:20,fontSize:16},children:"Checking admin..."}):a?t:(0,n.jsx)(i.A,{to:"/admin/login",replace:!0})}},6848:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var n=a(2115),s=a(63);function i(e){let{to:t="/",replace:a=!1}=e,i=(0,s.useRouter)();return(0,n.useEffect)(()=>{a?i.replace(t):i.push(t)},[t,a,i]),null}},7853:(e,t,a)=>{Promise.resolve().then(a.bind(a,6165)),Promise.resolve().then(a.bind(a,9750))},9109:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var n=a(5155),s=a(2619),i=a.n(s);function r(e){var t;let{to:a,href:s,...r}=e;return(0,n.jsx)(i(),{href:null!=(t=null!=s?s:a)?t:"#",...r})}},9750:(e,t,a)=>{"use strict";a.d(t,{default:()=>l});var n=a(5155),s=a(2115),i=a(4975),r=a(6165),d=a(9109);let o=["PLACED","CONFIRMED","IN_TRANSIT","DELIVERED","CANCELLED"];function c(){let e=i.F.adminToken(),[t,a]=(0,s.useState)([]),[r,c]=(0,s.useState)(!0),l=async()=>{try{c(!0);let t=await i.F.getAuth("/api/admin/orders",e);if(!(null==t?void 0:t.ok)){alert((null==t?void 0:t.message)||"Failed to load orders"),a([]);return}a(Array.isArray(t.orders)?t.orders:[])}finally{c(!1)}};(0,s.useEffect)(()=>{l()},[]);let m=async(t,a)=>{let n=await i.F.put("/api/admin/orders/".concat(t,"/status"),{status:a},e);if(!(null==n?void 0:n.ok))return alert((null==n?void 0:n.message)||"Failed to update status");l()};return(0,n.jsxs)("div",{className:"container adminOrdersWrap",children:[(0,n.jsxs)("div",{className:"rowBetween adminOrdersHeader",children:[(0,n.jsx)("h2",{children:"Admin Orders"}),(0,n.jsx)(d.A,{className:"btnGhost",to:"/admin",children:"← Back"})]}),r?(0,n.jsx)("div",{className:"box adminOrderCard",children:"Loading..."}):0===t.length?(0,n.jsx)("div",{className:"box adminOrderCard",children:"No orders found"}):t.map(e=>{var t;let a=e.shipping||{},s=Array.isArray(e.items)?e.items:[];return(0,n.jsxs)("div",{className:"box adminOrderCard",children:[(0,n.jsxs)("div",{className:"adminOrderTop",children:[(0,n.jsxs)("div",{className:"adminOrderTopLeft",children:[(0,n.jsxs)("div",{className:"adminOrderNoRow",children:[(0,n.jsxs)("div",{className:"adminOrderNo",children:["Order ",e.orderNo||e._id]}),(0,n.jsx)("span",{className:"adminStatusBadge st-".concat(String(e.status||"PLACED")),children:String(e.status||"PLACED").replaceAll("_"," ")})]}),(0,n.jsxs)("div",{className:"adminOrderMeta",children:[(0,n.jsx)("div",{className:"shipName",children:a.fullName||"No name"}),(0,n.jsxs)("div",{className:"shipPhones",children:[a.phone1||"No phone",a.phone2?", ".concat(a.phone2):""]}),(0,n.jsx)("div",{className:"shipAddress",children:a.addressLine||"No address"}),(0,n.jsxs)("div",{className:"shipArea",children:[a.upazila?"".concat(a.upazila,", "):"",a.district||"—",", ",a.division||"—"]}),a.note?(0,n.jsxs)("div",{className:"shipNote",children:["Note: ",a.note]}):null]})]}),(0,n.jsx)("div",{className:"adminOrderTopRight",children:(0,n.jsx)("div",{className:"adminOrderTime",children:e.createdAt?new Date(e.createdAt).toLocaleString():"—"})})]}),(0,n.jsx)("div",{className:"adminItems",children:0===s.length?(0,n.jsx)("div",{className:"muted",style:{marginTop:10},children:"No items"}):s.map((e,t)=>{let a=Number((null==e?void 0:e.qty)||0),s=Number((null==e?void 0:e.price)||0);return(0,n.jsxs)("div",{className:"adminItem",children:[(0,n.jsxs)("div",{className:"adminItemInfo",children:[(0,n.jsx)("div",{className:"adminItemTitle",children:(null==e?void 0:e.title)||"No title"}),(null==e?void 0:e.variant)?(0,n.jsx)("div",{className:"adminItemVar",children:e.variant}):null]}),(0,n.jsxs)("div",{className:"adminItemRight",children:[(0,n.jsxs)("div",{className:"adminQty",children:["x",a]}),(0,n.jsxs)("div",{className:"adminPrice",children:["৳ ",s*a]})]})]},t)})}),(0,n.jsxs)("div",{className:"adminBottom",children:[(0,n.jsxs)("div",{className:"adminTotal",children:["Total: ৳ ",null!=(t=e.total)?t:"—"]}),(0,n.jsx)("div",{className:"adminBottomRight",children:(0,n.jsx)("select",{className:"adminStatusSelect",value:e.status||"PLACED",onChange:t=>m(e._id,t.target.value),children:o.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})})]})]},e._id)})]})}function l(){return(0,n.jsx)(r.default,{children:(0,n.jsx)(c,{})})}}},e=>{e.O(0,[176,441,493,358],()=>e(e.s=7853)),_N_E=e.O()}]);