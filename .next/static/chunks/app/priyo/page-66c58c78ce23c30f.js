(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40,136],{731:(e,t,l)=>{Promise.resolve().then(l.bind(l,1789)),Promise.resolve().then(l.bind(l,4055))},1789:(e,t,l)=>{"use strict";l.d(t,{default:()=>s});var n=l(5155),r=l(6848),a=l(1834),i=l(4901),o=l(4975);function s(e){let{children:t}=e,{user:l,booting:s}=(0,i.A)();return((0,a.z)(),s)?(0,n.jsx)("div",{className:"softBox",children:"Loading..."}):o.F.token()&&l?t:(0,n.jsx)(r.A,{to:"/login",replace:!0})}},1834:(e,t,l)=>{"use strict";l.d(t,{z:()=>r});var n=l(63);function r(){let e=(0,n.usePathname)()||"/",t=(0,n.useSearchParams)();return{pathname:e,search:(null==t?void 0:t.toString())?"?".concat(t.toString()):""}}},4055:(e,t,l)=>{"use strict";l.d(t,{default:()=>m});var n=l(5155),r=l(9109),a=l(1834),i=l(4842),o=l(2115),s=l(6130),c=l(4901),u=l(5167),d=l(4975),v=l(9954);function m(){(0,v.A)("noindex, nofollow");let e=(0,i.Z)(),{pathname:t}=(0,a.z)(),l=(0,s.r)(),{user:m}=(0,c.A)(),{buyNow:h}=(0,u._)();if(t.startsWith("/admin"))return null;let f=Array.isArray(null==l?void 0:l.favIds)?l.favIds:[],[p,g]=(0,o.useState)(!1),[x,j]=(0,o.useState)([]);(0,o.useEffect)(()=>{let e=!0;return async function(){if(!f.length)return j([]);g(!0);try{let t=await d.F.get("/api/products");if(!e)return;if((null==t?void 0:t.ok)&&Array.isArray(null==t?void 0:t.products)){let e=new Map(t.products.map(e=>[String(e._id),e])),l=f.map(t=>e.get(String(t))).filter(Boolean);j(l)}else j([])}catch(t){if(!e)return;j([])}finally{if(!e)return;g(!1)}}(),()=>{e=!1}},[f.join("|")]);let b=f.length,N=e=>(null==l?void 0:l.remove)?l.remove(e):(null==l?void 0:l.removeFav)?l.removeFav(e):(null==l?void 0:l.removeFavorite)?l.removeFavorite(e):(null==l?void 0:l.toggle)?l.toggle(e):(null==l?void 0:l.toggleFav)?l.toggleFav(e):void 0,y=(null==f?void 0:f[0])?String(f[0]):null,A=(0,o.useMemo)(()=>y&&x.find(e=>String(null==e?void 0:e._id)===y)||null,[y,x]);return(0,n.jsxs)("div",{className:"container favPage",children:[(0,n.jsxs)("div",{className:"favHead",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"favTitle",style:{margin:0},children:"My Favorites"}),(0,n.jsxs)("div",{className:"favSub",children:[(null==m?void 0:m.phone)||(null==m?void 0:m.email)||"Guest"," — ",(0,n.jsxs)("b",{children:["Total: ",b]})]})]}),(0,n.jsx)("button",{className:"favBackBtn",type:"button",onClick:()=>e(-1),children:"← Back"})]}),b?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"favTopActions",children:[(0,n.jsx)("button",{type:"button",className:"favPrimaryBtn",onClick:()=>{if(!m)return e("/login");if(null==A?void 0:A._id){h(A,"",1),e("/checkout?mode=buy");return}e("/shop")},children:"Checkout (First Favorite)"}),(0,n.jsx)("button",{type:"button",className:"favGhostBtn",onClick:()=>(null==l?void 0:l.clear)?l.clear():(null==l?void 0:l.clearAll)?l.clearAll():(null==l?void 0:l.reset)?l.reset():void f.forEach(e=>N(e)),children:"Clear All"})]}),p?(0,n.jsx)("div",{className:"favEmpty",children:"Loading favorites…"}):x.length?(0,n.jsx)("div",{className:"favList",children:x.map((e,t)=>{var l;let a=String((null==e?void 0:e._id)||""),i=(null==e?void 0:e.title)||"Product",o=Number(null==e?void 0:e.price)||0,s=(null==e||null==(l=e.images)?void 0:l[0])||(null==e?void 0:e.image)||(null==e?void 0:e.thumb)||"https://via.placeholder.com/320x240?text=Product";return(0,n.jsxs)("div",{className:"favItem",children:[(0,n.jsx)(r.A,{to:"/product/".concat(a),className:"favThumb",children:(0,n.jsx)("img",{src:s,alt:i,loading:"lazy",onError:e=>{e.currentTarget.src="https://via.placeholder.com/320x240?text=Product"}})}),(0,n.jsxs)("div",{className:"favInfo",children:[(0,n.jsx)(r.A,{to:"/product/".concat(a),className:"favItemTitle",children:i}),(0,n.jsx)("div",{className:"favPrice",children:"৳ ".concat(Math.round(Number(o)||0).toLocaleString("en-US"))}),(0,n.jsxs)("div",{className:"favBtns",children:[(0,n.jsx)(r.A,{to:"/product/".concat(a),className:"favViewBtn",children:"View"}),(0,n.jsx)("button",{type:"button",className:"favRemoveBtn",onClick:()=>N(a),children:"Remove"})]})]})]},a||"".concat(t))})}):(0,n.jsxs)("div",{className:"favEmpty",children:["Favorites আছে (IDs: ",f.length,") কিন্তু product list এ match হয়নি।",(0,n.jsx)("br",{}),"(সম্ভবত /api/products এ এই আইডি গুলো নেই)"]})]}):(0,n.jsxs)("div",{className:"favEmpty",children:["No favorites yet. ",(0,n.jsx)(r.A,{to:"/shop",children:"Go to shop"})]})]})}},4842:(e,t,l)=>{"use strict";l.d(t,{Z:()=>r});var n=l(63);function r(){let e=(0,n.useRouter)();return function(t){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"==typeof t?t:String(t);(null==l?void 0:l.replace)?e.replace(n):e.push(n)}}},6848:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});var n=l(2115),r=l(63);function a(e){let{to:t="/",replace:l=!1}=e,a=(0,r.useRouter)();return(0,n.useEffect)(()=>{l?a.replace(t):a.push(t)},[t,l,a]),null}},9109:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var n=l(5155),r=l(2619),a=l.n(r);function i(e){var t;let{to:l,href:r,...i}=e;return(0,n.jsx)(a(),{href:null!=(t=null!=r?r:l)?t:"#",...i})}},9954:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var n=l(2115);function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"noindex, nofollow";(0,n.useEffect)(()=>{let t=document.querySelector('meta[name="robots"]'),l=(null==t?void 0:t.getAttribute("content"))||null;return t||((t=document.createElement("meta")).setAttribute("name","robots"),document.head.appendChild(t)),t.setAttribute("content",e),()=>{let e=document.querySelector('meta[name="robots"]');e&&(l?e.setAttribute("content",l):e.remove())}},[])}}},e=>{e.O(0,[176,901,441,493,358],()=>e(e.s=731)),_N_E=e.O()}]);